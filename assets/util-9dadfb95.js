async function m(n,a=5){const o=a*1024*1024,e=await g(n),t=document.createElement("canvas"),h=t.getContext("2d"),r=1920,s=e.width/e.height;e.width>r?(t.width=r,t.height=r/s):(t.width=e.width,t.height=e.height),h.drawImage(e,0,0,t.width,t.height);let c=.92,i=null;for(;c>.1&&(i=await new Promise(w=>{t.toBlob(w,"image/jpeg",c)}),!(i&&i.size<=o));)c-=.05;if(!i)throw new Error("图片压缩失败");return new File([i],n.name,{type:"image/jpeg"})}function g(n){return new Promise((a,o)=>{const e=new Image;e.onload=()=>a(e),e.onerror=()=>o(new Error("图片加载失败")),e.src=URL.createObjectURL(n)})}export{m as c};
